<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GSoC 2025 - VideoLAN | Arthur Norat</title>
    <link rel="stylesheet" href="../style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="icon" href="../assets/favicon.png" type="image/x-icon">
</head>
<body>

<!-- NAVIGATION -->
<nav id="desktop-nav">
    <div class="logo">Arthur Norat</div>
    <div>
        <ul class="nav-links">
            <li><a href="index.html">Portafolio</a></li>
            <li class="lang-switcher">
                <a href="../pt-br/gsoc2025.html" class="lang-btn" aria-label="Portugu√™s (Brasil)" title="Portugu√™s (Brasil)">üáßüá∑</a>
                <a href="../gsoc2025.html" class="lang-btn" aria-label="English (US)" title="English (US)">üá∫üá∏</a>
                <a href="./gsoc2025.html" class="lang-btn active" aria-label="Espa√±ol (MX)" title="Espa√±ol (MX)">üá≤üáΩ</a>
            </li>                
        </ul>
    </div>        
</nav>

<!-- PROJECT HEADER -->
    
    <section id="project-header">
        <div class="header-container">
            <div class="header-content">
                <div class="header-text">
                    <p class="project-category">Google Summer of Code 2025</p>
                    <h1 class="project-title">Funci√≥n de Control Parental</h1>
                    <p class="project-subtitle">Desarrollo de Aplicaci√≥n VLC iOS</p>
                    <div class="project-meta">
                        <span class="meta-item">
                            <i class='bx bx-calendar'></i>
                            Junio - Agosto 2025
                        </span>
                        <span class="meta-item">
                            <i class='bx bx-code-alt'></i>
                            Swift, Objective-C, iOS
                        </span>
                        <span class="meta-item">
                            <i class='bx bx-git-branch'></i>
                            C√≥digo Abierto
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </section>

<!-- PROJECT LINKS -->
    
    <section id="project-links">
        <div class="btn-container">
            <a href="https://code.videolan.org/videolan/vlc-ios/-/merge_requests/1457" target="_blank" rel="noopener noreferrer">
                <button class="btn-1">Ver en GitLab</button>
            </a>
            <a href="https://summerofcode.withgoogle.com/programs/2025/projects/LQHsm73T" target="_blank" rel="noopener noreferrer">
                <button class="btn-2">P√°gina del Proyecto GSoC</button>
            </a>
        </div>
    </section>

<!-- ARTICLE CONTENT -->
    
    <section id="article-content">
        <div class="article-container">
            <div class="article-body">
                <h1>Evaluaci√≥n Final ‚Äì Funci√≥n de Control Parental para VLC-iOS</h1>
                
                <p>Cuando comenc√© este proyecto, el objetivo era claro: implementar un sistema de <strong>Control Parental</strong> en VLC para iOS que pudiera proteger funciones sensibles, como eliminar archivos multimedia, acceder a configuraciones y abrir transmisiones de red, requiriendo autenticaci√≥n a trav√©s de un c√≥digo de acceso o Face ID. El objetivo era proporcionar una experiencia m√°s segura para las familias, particularmente para padres que comparten sus dispositivos con ni√±os peque√±os.</p>
                
                <p>Pero desde el principio, me di cuenta de que esta tarea no ser√≠a simple. De hecho, result√≥ ser <strong>la experiencia t√©cnica m√°s desafiante que he tenido</strong>, mucho m√°s compleja que cualquier cosa que haya enfrentado en la universidad, proyectos personales o trabajo freelance. Y no solo por el c√≥digo. Este tambi√©n fue mi <strong>primer proyecto colaborativo de c√≥digo abierto</strong>, lo que significaba aprender a navegar por una base de c√≥digo compartida, respetar los cambios de otros contribuyentes y mantener un historial de Git limpio y revisable, algo que nunca hab√≠a hecho antes.</p>
                
                <h2>Primeros Pasos y Desaf√≠os de Git</h2>
                
                <p>A principios de junio, comenc√© dise√±ando la estructura de una nueva clase, <code>ParentalControlCoordinator</code>, que manejar√≠a todos los aspectos de la autenticaci√≥n. Sin embargo, r√°pidamente tuve problemas al trabajar con Git. Despu√©s de ejecutar un <code>git rebase master</code>, accidentalmente introduje docenas de commits no relacionados en mi merge request. Me tom√≥ m√°s de una semana entender c√≥mo limpiar el historial de commits correctamente usando <code>git reset</code> y <code>git push --force</code>, pero eventualmente pude recuperar la rama y dejarla lista para desarrollo nuevamente.</p>
                
                <h2>Primera Versi√≥n ‚Äì L√≥gica B√°sica de Autenticaci√≥n</h2>
                
                <p>Una vez que los problemas de Git fueron resueltos, comenc√© a experimentar con la l√≥gica real de la funcionalidad. El primer m√©todo que cre√© fue:</p>
                
                <pre><code>func authenticate(completion: @escaping (Bool) -> Void)</code></pre>
                
                <p>Verificaba si el control parental estaba habilitado y, si es as√≠, llamaba:</p>
                
                <pre><code>keychain.validateSecret(allowBiometricAuthentication: true, isCancellable: true)</code></pre>
                
                <p>Esto funcionaba en algunos escenarios pero revel√≥ una gran falla arquitect√≥nica: <strong>la funcionalidad de control parental estaba vinculada al Passcode Lock</strong>, una funcionalidad que solicita al usuario que ingrese un c√≥digo de acceso al abrir la aplicaci√≥n. Si el Passcode Lock estuviera deshabilitado, el control parental no funcionar√≠a en absoluto.</p>
                
                <h2>Independencia Entre Funcionalidades</h2>
                
                <p>Para resolver esto, cre√© una <strong>entrada separada en el keychain</strong> dedicada al control parental. Luego refactoric√© el <code>ParentalControlCoordinator</code> para eliminar todas las dependencias de <code>UserDefaults</code> y reutilic√© el <code>KeychainCoordinator</code> solo para l√≥gica relacionada con mostrar la pantalla de c√≥digo de acceso. Esto permiti√≥ que el control parental y el bloqueo por c√≥digo funcionaran <strong>completamente independientes</strong>, como deber√≠an.</p>
                
                <h2>Protegiendo Acciones ‚Äì M√©todo por M√©todo</h2>
                
                <p>Con la l√≥gica de autenticaci√≥n funcionando, pas√© a proteger funcionalidades individuales. Para evitar duplicaci√≥n de c√≥digo, cre√© un m√©todo centralizado:</p>
                
                <pre><code>func authorizeIfParentalControlIsEnabled(with action: @escaping () -> Void)</code></pre>
                
                <p>Este m√©todo era entonces llamado antes de cada acci√≥n restringida. Aqu√≠ est√° c√≥mo fue integrado en toda la aplicaci√≥n:</p>
                
                <ul>
                    <li><strong>Renombrar un archivo</strong>: Dentro de <code>EditActions.rename(...)</code></li>
                    <li><strong>Eliminar un archivo</strong>: En <code>EditActions.delete(...)</code></li>
                    <li><strong>Abrir la pantalla de configuraciones</strong>: Via <code>TabBarCoordinator</code> usando <code>tabBarController(_:shouldSelect:)</code> y <code>handleAppDidBecomeActive()</code></li>
                    <li><strong>Abrir una transmisi√≥n de red</strong>: En <code>_openURLStringAndDismiss()</code></li>
                    <li><strong>Descargar archivos</strong>: Tambi√©n en <code>_openURLStringAndDismiss()</code></li>
                    <li><strong>Acceder a archivos locales</strong>: En <code>RemoteNetworkDataSource</code>, via <code>tableView(_:didSelectRowAt:)</code></li>
                    <li><strong>Agregar/eliminar archivos de playlists/grupos de medios</strong>: En <code>EditActions</code>, envolviendo la l√≥gica con <code>authorizeIfParentalControlIsEnabled</code></li>
                </ul>
                
                <h2>L√≥gica de Sesi√≥n y Timeout</h2>
                
                <p>Para evitar abrumar al usuario con solicitudes constantes de c√≥digo de acceso, implement√© una <strong>sesi√≥n de desbloqueo temporal</strong>. Despu√©s de una autenticaci√≥n exitosa, un timestamp era almacenado usando:</p>
                
                <pre><code>private var lastAuthenticationDate: Date?</code></pre>
                
                <p>Luego verifiqu√© el tiempo transcurrido usando:</p>
                
                <pre><code>var isParentalControlUnlocked: Bool</code></pre>
                
                <p>Esto permit√≠a a los usuarios realizar m√∫ltiples acciones protegidas dentro de una ventana de 30 segundos sin re-autenticar.</p>
                
                <h2>Autenticaci√≥n Biom√©trica ‚Äì El √öltimo Obst√°culo</h2>
                
                <p>El √∫ltimo y m√°s frustrante desaf√≠o fue la <strong>integraci√≥n del Face ID</strong>. Si el usuario abr√≠a la aplicaci√≥n usando Face ID (via Passcode Lock), luego intentaba autenticar nuevamente para control parental, la pantalla del Face ID aparecer√≠a repetidamente y nunca se descartar√≠a.</p>
                
                <p>Aunque la autenticaci√≥n fuera <strong>t√©cnicamente exitosa</strong>, el prompt biom√©trico permanecer√≠a visible. Intent√© de todo, desde refactorizar los m√©todos existentes hasta crear un nuevo <code>showPasscodeController()</code> dentro del <code>ParentalControlCoordinator</code>, y verificar <code>LAContext</code>, pero el problema persist√≠a.</p>
                
                <h2>Estado Actual y Lo Que Queda</h2>
                
                <p>La funcionalidad est√° actualmente en un estado avanzado y testeable. Protege exitosamente todas las acciones principales y proporciona una buena experiencia de usuario gracias a la l√≥gica de sesi√≥n de desbloqueo.</p>
                
                <p>Sin embargo, <strong>la merge request a√∫n no ha sido fusionada upstream</strong> debido al <strong>conflicto no resuelto con Face ID</strong>, que parece requerir investigaci√≥n m√°s profunda y colaboraci√≥n.</p>
                
                <h2>Reflexiones</h2>
                
                <p>Este proyecto ha sido <strong>un viaje incre√≠ble</strong>. Tuve la libertad de dise√±ar la l√≥gica y estructurar la arquitectura. Esa autonom√≠a creativa es uno de los aspectos m√°s gratificantes de trabajar en c√≥digo abierto.</p>
                
                <p>Al mismo tiempo, me llev√≥ a mis l√≠mites. Tuve que aprender Git de la manera dif√≠cil, sumergirme en una base de c√≥digo grande y arreglar bugs que ni siquiera sab√≠a c√≥mo describir al principio.</p>
                
                <p>Aunque a√∫n no ha sido fusionado, realmente creo que este es el <strong>primer borrador s√≥lido</strong> de una funcionalidad significativa. Una que puede ser refinada y eventualmente agregada al VLC para iOS para mejorar la experiencia para familias alrededor del mundo.</p>
            </div>
        </div>
    </section>

<!-- FOOTER -->    
    
<footer class="footer">
    <p>&copy; 2024 Arthur Norat. Todos los derechos reservados.</p>
</footer>

</body>
</html>
