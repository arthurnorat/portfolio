<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GSoC 2025 - VideoLAN | Arthur Norat</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="icon" href="./assets/favicon.png" type="image/x-icon">
</head>
<body>

<!-- NAVIGATION -->
<nav id="desktop-nav">
    <div class="logo">Arthur Norat</div>
    <div>
        <ul class="nav-links">
            <li><a href="index.html">Portfolio</a></li>
            <li class="lang-switcher">
                <a href="./pt-br/gsoc2025.html" class="lang-btn" aria-label="PortuguÃªs (Brasil)" title="PortuguÃªs (Brasil)">ðŸ‡§ðŸ‡·</a>
                <a href="./gsoc2025.html" class="lang-btn active" aria-label="English (US)" title="English (US)">ðŸ‡ºðŸ‡¸</a>
                <a href="./es/gsoc2025.html" class="lang-btn" aria-label="EspaÃ±ol (MX)" title="EspaÃ±ol (MX)">ðŸ‡²ðŸ‡½</a>
            </li>                
        </ul>
    </div>        
</nav>

<!-- PROJECT HEADER -->
    
    <section id="project-header">
        <div class="header-container">
            <div class="header-content">
                <div class="header-text">
                    <p class="project-category">Google Summer of Code 2025</p>
                    <h1 class="project-title">Parental Control Feature</h1>                    
                    <div class="project-meta">
                        <span class="meta-item">
                            <i class='bx bx-calendar'></i>
                            June - August 2025
                        </span>
                        <span class="meta-item">
                            <i class='bx bx-code-alt'></i>
                            Swift, Objective-C, iOS
                        </span>
                        <span class="meta-item">
                            <i class='bx bx-git-branch'></i>
                            Open Source
                        </span>
                    </div>
                </div>                
            </div>
        </div>
    </section>

<!-- PROJECT LINKS -->
    
    <section id="project-links">
        <div class="btn-container">
            <a href="https://code.videolan.org/videolan/vlc-ios/-/merge_requests/1457" target="_blank" rel="noopener noreferrer">
                <button class="btn-1">View on GitLab</button>
            </a>
            <a href="https://summerofcode.withgoogle.com/programs/2025/projects/LQHsm73T" target="_blank" rel="noopener noreferrer">
                <button class="btn-2">GSoC Project Page</button>
            </a>
        </div>
    </section>

<!-- ARTICLE CONTENT -->
    
    <section id="article-content">
        <div class="article-container">
            <div class="article-body">
                <h1>Final Evaluation â€“ Parental Control Feature for VLC-iOS</h1>
                
                <p>When I first started this project, the goal was clear: implement a <strong>Parental Control</strong> system in VLC for iOS that could protect sensitive features, such as deleting media files, accessing settings, and opening network streams, by requiring authentication through a passcode or Face ID. The goal was to provide a safer experience for families, particularly parents who share their devices with young children.</p>
                
                <p>But from the very beginning, I realized this task would not be simple. In fact, it turned out to be <strong>the most challenging technical experience I've ever had</strong>, far more complex than anything I've faced in college, personal projects, or freelance work. And not just because of the code. This was also my <strong>first collaborative open source project</strong>, which meant learning how to navigate a shared codebase, respect other contributors' changes, and maintain a clean and reviewable Git history, something I had never done before.</p>
                
                <h2>First Steps & Git Challenges</h2>
                
                <p>In early June, I began by designing the structure of a new class, <code>ParentalControlCoordinator</code>, which would handle all aspects of authentication. However, I quickly ran into trouble while working with Git. After running a <code>git rebase master</code>, I accidentally introduced dozens of unrelated commits into my merge request. It took me over a week to understand how to clean the commit history properly using <code>git reset</code> and <code>git push --force</code>, but eventually I was able to recover the branch and make it ready for development again.</p>
                
                <h2>First Version â€“ Basic Authentication Logic</h2>
                
                <p>Once the Git issues were resolved, I started experimenting with the actual logic of the feature. The first method I created was:</p>
                
                <pre><code>func authenticate(completion: @escaping (Bool) -> Void)</code></pre>
                
                <p>It verified whether parental control was enabled and, if so, called:</p>
                
                <pre><code>keychain.validateSecret(allowBiometricAuthentication: true, isCancellable: true)</code></pre>
                
                <p>This worked in some scenarios but revealed a big architectural flaw: <strong>the parental control feature was tied to the Passcode Lock</strong>, a feature that prompts the user to enter a passcode when opening the app. If Passcode Lock was disabled, parental control would not function at all.</p>
                
                <h2>Independence Between Features</h2>
                
                <p>To solve this, I created a <strong>separate keychain entry</strong> dedicated to parental control. I then refactored <code>ParentalControlCoordinator</code> to remove all dependencies on <code>UserDefaults</code> and reused the <code>KeychainCoordinator</code> only for logic related to displaying the passcode screen. This allowed parental control and passcode lock to <strong>function completely independently</strong>, just as they should.</p>
                
                <h2>Protecting Actions â€“ Method by Method</h2>
                
                <p>With the authentication logic working, I moved on to protecting individual features. To avoid duplicating code, I created a centralized method:</p>
                
                <pre><code>func authorizeIfParentalControlIsEnabled(with action: @escaping () -> Void)</code></pre>
                
                <p>This method was then called before each restricted action. Here's how it was integrated across the app:</p>
                
                <ul>
                    <li><strong>Renaming a file</strong>: Inside <code>EditActions.rename(...)</code></li>
                    <li><strong>Deleting a file</strong>: In <code>EditActions.delete(...)</code></li>
                    <li><strong>Opening the settings screen</strong>: Via <code>TabBarCoordinator</code> using <code>tabBarController(_:shouldSelect:)</code> and <code>handleAppDidBecomeActive()</code></li>
                    <li><strong>Opening a network stream</strong>: In <code>_openURLStringAndDismiss()</code></li>
                    <li><strong>Downloading files</strong>: Also in <code>_openURLStringAndDismiss()</code></li>
                    <li><strong>Accessing local files</strong>: In <code>RemoteNetworkDataSource</code>, via <code>tableView(_:didSelectRowAt:)</code></li>
                    <li><strong>Adding/removing files from playlists/media groups</strong>: In <code>EditActions</code>, wrapping the logic with <code>authorizeIfParentalControlIsEnabled</code></li>
                </ul>
                
                <h2>Session Logic and Timeout</h2>
                
                <p>To avoid overwhelming the user with constant passcode prompts, I implemented a <strong>temporary unlock session</strong>. After successful authentication, a timestamp was stored using:</p>
                
                <pre><code>private var lastAuthenticationDate: Date?</code></pre>
                
                <p>I then checked the elapsed time using:</p>
                
                <pre><code>var isParentalControlUnlocked: Bool</code></pre>
                
                <p>This allowed users to perform multiple protected actions within a 30 second window without re-authenticating.</p>
                
                <h2>Biometric Authentication â€“ The Final Hurdle</h2>
                
                <p>The last and most frustrating challenge was <strong>Face ID integration</strong>. If the user opened the app using Face ID (via Passcode Lock), then tried to authenticate again for parental control, the Face ID screen would appear again and again, and would never dismiss.</p>
                
                <p>Even though the authentication was <strong>technically successful</strong>, the biometric prompt would remain visible. I tried everything, from refactoring the existing methods to creating a new <code>showPasscodeController()</code> inside <code>ParentalControlCoordinator</code>, and checking <code>LAContext</code>, but the problem persisted.</p>
                
                <h2>Current Status and What's Left</h2>
                
                <p>The feature is currently in an advanced and testable state. It successfully protects all major actions and provides a good user experience thanks to the unlock session logic.</p>
                
                <p>However, <strong>the merge request has not yet been merged upstream</strong> because of the <strong>unresolved conflict with Face ID</strong>, which seems to require deeper investigation and collaboration.</p>
                
                <h2>Reflections</h2>
                
                <p>This project has been <strong>an amazing journey</strong>. I had the freedom to design the logic and structure the architecture. That creative autonomy is one of the most rewarding aspects of working in open source.</p>
                
                <p>At the same time, it pushed me to my limits. I had to learn Git the hard way, dive into a large codebase, and fix bugs I didn't even know how to describe at first.</p>
                
                <p>Although it's not merged yet, I believe this is the <strong>first solid draft</strong> of an useful feature. One that can be refined and eventually added to VLC for iOS to improve the experience for families around the world.</p>
            </div>
        </div>
    </section>

<!-- FOOTER -->    
    
<footer class="footer">
    <p>&copy; 2025 Arthur Norat. All rights reserved.</p>
</footer>

</body>
</html>
